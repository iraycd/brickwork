/**
 * brickwork - BrickWork is a reponsive jQuery plugin to create Dynamic layouts
 * @version v1.0.0
 * @link iraycd.github.io/brickwork
 * @license MIT
 * @author Ray Ch
 */
!function(t){function i(i){var e=(runtime.gutterX,runtime.gutterY,runtime.cellH),n=runtime.cellW,o=t(i),r=o.find(o.attr("data-handle"));a.setDraggable(i,{handle:r[0],onStart:function(){setting.animate&&a.transition&&a.setTransition(this,""),o.css("z-index",9999).addClass("fw-float")},onDrag:function(){var t=o.position(),i=Math.round(t.top/e),a=Math.round(t.left/n),r=Math.round(o.width()/n),l=Math.round(o.height()/e);i=Math.min(Math.max(0,i),runtime.limitRow-l),a=Math.min(Math.max(0,a),runtime.limitCol-r),control.setHoles({top:i,left:a,width:r,height:l}),control.refresh()},onDrop:function(){var i=o.position(),a=Math.round(i.top/e),r=Math.round(i.left/n),l=Math.round(o.width()/n),h=Math.round(o.height()/e);a=Math.min(Math.max(0,a),runtime.limitRow-h),r=Math.min(Math.max(0,r),runtime.limitCol-l),o.removeClass("fw-float"),o.css({zIndex:"auto",top:a*e,left:r*n});var u,d,s,c;for(d=0;h>d;++d)for(u=0;l>u;++u)s=d+a+"-"+(u+r),c=runtime.matrix[s],c&&1!=c&&t("#"+c).removeAttr("data-position");runtime.holes={},o.attr({"data-width":o.width(),"data-height":o.height(),"data-position":a+"-"+r}),control.refresh()}})}null==t.isNumeric&&(t.isNumeric=function(t){return null!=t&&t.constructor===Number}),null==t.isFunction&&(t.isFunction=function(t){return null!=t&&t instanceof Function});var e=t(window),n=t(document),a={defaultConfig:{animate:!1,cellW:100,cellH:100,delay:0,engine:"giot",fixSize:null,gutterX:15,gutterY:15,selector:"> div",draggable:!1,rightToLeft:!1,bottomToTop:!1,onGapFound:function(){},onComplete:function(){},onResize:function(){},onBlockReady:function(){},onBlockFinish:function(){},onBlockActive:function(){}},plugin:{},totalGrid:1,transition:!1};a.adjustBlock=function(i,e){var n=e.runtime,a=n.gutterX,o=n.gutterY,r=t("#"+i.id),l=n.cellH,h=n.cellW;"auto"==e.cellH&&(r.width(i.width*h-a),r[0].style.height="",i.height=Math.round((r.height()+o)/l))},a.adjustUnit=function(i,e,n){var a=n.gutterX,o=n.gutterY,r=n.runtime,l=n.cellW,h=n.cellH;if(t.isFunction(l)&&(l=l(i)),l=1*l,!t.isNumeric(l)&&(l=1),t.isFunction(h)&&(h=h(e)),h=1*h,!t.isNumeric(h)&&(h=1),t.isNumeric(i)){1>l&&(l*=i);var u=Math.max(1,Math.floor(i/l));t.isNumeric(a)||(a=(i-u*l)/Math.max(1,u-1),a=Math.max(0,a)),u=Math.floor((i+a)/l),r.cellW=(i+a)/Math.max(u,1),r.cellS=r.cellW/l,r.gutterX=a,r.limitCol=u}if(t.isNumeric(e)){1>h&&(h*=e);var d=Math.max(1,Math.floor(e/h));t.isNumeric(o)||(o=(e-d*h)/Math.max(1,d-1),o=Math.max(0,o)),d=Math.floor((e+o)/h),r.cellH=(e+o)/Math.max(d,1),r.cellS=r.cellH/h,r.gutterY=o,r.limitRow=d}t.isNumeric(i)||(1>l&&(l=r.cellH),r.cellW=1!=l?l*r.cellS:1,r.gutterX=a,r.limitCol=666666),t.isNumeric(e)||(1>h&&(h=r.cellW),r.cellH=1!=h?h*r.cellS:1,r.gutterY=o,r.limitRow=666666)},a.getFreeArea=function(t,i,e){for(var n=Math.min(t+e.maxHoB,e.limitRow),a=Math.min(i+e.maxWoB,e.limitCol),o=a,r=n,l=e.matrix,h=t;r>h;++h)for(var u=i;a>u;++u)l[h+"-"+u]&&u>i&&o>u&&(o=u);for(var h=t;n>h;++h)for(var u=i;o>u;++u)l[h+"-"+u]&&h>t&&r>h&&(r=h);return{top:t,left:i,width:o-i,height:r-t}},a.loadBlock=function(i,e){var n=e.runtime,a=t(i),o=null,r=n.gutterX,l=n.gutterY,h=parseInt(a.attr("data-fixSize")),u=n.lastId++ +"-"+n.totalGrid;if(!a.hasClass("fw-float")){a.attr({id:u,"data-delay":i.index}),e.animate&&this.transition&&this.setTransition(i,""),null==a.attr("data-height")&&a.attr("data-height",a.height()),null==a.attr("data-width")&&a.attr("data-width",a.width());var d=1*a.attr("data-height"),s=1*a.attr("data-width"),c=a.attr("data-position"),f=n.cellH,g=n.cellW,m=s?Math.round((s+r)/g):0,w=d?Math.round((d+l)/f):0;if(isNaN(h)&&(h=null),h||"auto"!=e.cellH||(a.width(g*m-r),i.style.height="",d=a.height(),w=d?Math.round((d+l)/f):0),h||"auto"!=e.cellW||(a.height(f*w-l),i.style.width="",s=a.width(),m=s?Math.round((s+r)/g):0),null!=h&&(m>n.limitCol||w>n.limitRow))o=null;else if(w&&w<n.minHoB&&(n.minHoB=w),m&&m<n.minWoB&&(n.minWoB=m),w>n.maxHoB&&(n.maxHoB=w),m>n.maxWoB&&(n.maxWoB=m),0==s&&(m=0),0==d&&(w=0),o={id:u,width:m,height:w,fixSize:h},c){c=c.split("-"),o.y=1*c[0],o.x=1*c[1],o.width=null!=h?m:Math.min(m,n.limitCol-o.x),o.height=null!=h?w:Math.min(w,n.limitRow-o.y);var v=o.y+"-"+o.x+"-"+o.width+"-"+o.height;n.holes[v]={id:o.id,top:o.y,left:o.x,width:o.width,height:o.height},this.setBlock(o,e)}return null==a.attr("data-state")?a.attr("data-state","init"):a.attr("data-state","move"),e.onBlockReady.call(i,o,e),c?null:o}},a.nestedGrid=function(i,e){var n,a=t(i),o=e.runtime,r=a.attr("data-gutterX")||e.gutterX,l=a.attr("data-gutterY")||e.gutterY,h=a.attr("data-method")||"fitZone",u=a.attr("data-nested")||"> div",d=a.attr("data-cellH")||e.cellH,s=a.attr("data-cellW")||e.cellW,c=o.blocks[i.id];if(c)switch(n=new brickwork(a),n.reset({cellH:d,cellW:s,gutterX:1*r,gutterY:1*l,selector:u}),h){case"fitHeight":n[h](c.height);break;case"fitWidth":n[h](c.width);break;case"fitZone":n[h](c.width,c.height)}},a.resetGrid=function(t){t.blocks={},t.length=0,t.cellH=0,t.cellW=0,t.lastId=1,t.matrix={},t.totalCol=0,t.totalRow=0},a.setBlock=function(t,i){var e=i.runtime,n=e.gutterX,a=e.gutterY,o=t.height,r=t.width,l=e.cellH,h=e.cellW,u=t.x,d=t.y;i.rightToLeft&&(u=e.limitCol-u-r),i.bottomToTop&&(d=e.limitRow-d-o);var s={fixSize:t.fixSize,top:d*l,left:u*h,width:h*r-n,height:l*o-a};return s.top=1*s.top.toFixed(2),s.left=1*s.left.toFixed(2),s.width=1*s.width.toFixed(2),s.height=1*s.height.toFixed(2),t.id&&(e.blocks[t.id]=s),s},a.setDraggable=function(i,e){var a=!1,o={startX:0,startY:0,top:0,left:0,handle:null,onDrop:function(){},onDrag:function(){},onStart:function(){}};t(i).each(function(){function i(t){return t.stopPropagation(),t=t.originalEvent,t.touches&&(a=!0,t=t.changedTouches[0]),2!=t.button&&3!=t.which&&(h.onStart.call(d,t),h.startX=t.clientX,h.startY=t.clientY,h.top=parseInt(s.css("top"))||0,h.left=parseInt(s.css("left"))||0,n.bind("mouseup touchend",l),n.bind("mousemove touchmove",r)),!1}function r(t){t=t.originalEvent,a&&(t=t.changedTouches[0]),s.css({top:h.top-(h.startY-t.clientY),left:h.left-(h.startX-t.clientX)}),h.onDrag.call(d,t)}function l(t){t=t.originalEvent,a&&(t=t.changedTouches[0]),h.onDrop.call(d,t),n.unbind("mouseup touchend",l),n.unbind("mousemove touchmove",r)}var h=t.extend({},o,e),u=h.handle||this,d=this,s=t(d),c=t(u),f=s.css("position");"absolute"!=f&&s.css("position","relative"),s.find("iframe, form, input, textarea, .ignore-drag").each(function(){t(this).on("touchstart mousedown",function(t){t.stopPropagation()})}),n.unbind("mouseup touchend",l),n.unbind("mousemove touchmove",r),c.unbind("mousedown touchstart").bind("mousedown touchstart",i)})},a.setTransition=function(i,e){var n=i.style,a=t(i);!this.transition&&a.stop?a.stop():null!=n.webkitTransition?n.webkitTransition=e:null!=n.MozTransition?n.MozTransition=e:null!=n.msTransition?n.msTransition=e:null!=n.OTransition?n.OTransition=e:n.transition=e},a.setWallSize=function(t,i){var e=t.totalRow,n=t.totalCol,a=t.gutterY,o=t.gutterX,r=t.cellH,l=t.cellW,h=Math.max(0,l*n-o),u=Math.max(0,r*e-a);i.attr({"data-total-col":n,"data-total-row":e,"data-wall-width":Math.ceil(h),"data-wall-height":Math.ceil(u)}),t.limitCol<t.limitRow&&!i.attr("data-height")&&i.height(Math.ceil(u))},a.showBlock=function(i,e){function n(){if(u&&l.attr("data-state","start"),e.animate&&h.transition&&h.setTransition(i,d),r)r.fixSize&&(r.height=1*l.attr("data-height"),r.width=1*l.attr("data-width")),l.css({opacity:1,width:r.width,height:r.height}),l[o]({top:r.top,left:r.left}),null!=l.attr("data-nested")&&h.nestedGrid(i,e);else{var t=parseInt(i.style.height)||0,n=parseInt(i.style.width)||0,s=parseInt(i.style.left)||0,c=parseInt(i.style.top)||0;l[o]({left:s+n/2,top:c+t/2,width:0,height:0,opacity:0})}a.length-=1,e.onBlockFinish.call(i,r,e),0==a.length&&e.onComplete.call(i,r,e)}var a=e.runtime,o=e.animate&&!this.transition?"animate":"css",r=a.blocks[i.id],l=t(i),h=this,u="move"!=l.attr("data-state"),d=u?"width 0.5s, height 0.5s":"top 0.5s, left 0.5s, width 0.5s, height 0.5s, opacity 0.5s";i.delay&&clearTimeout(i.delay),l.hasClass("fw-float")||(h.setTransition(i,""),i.style.position="absolute",e.onBlockActive.call(i,r,e),e.delay>0?i.delay=setTimeout(n,e.delay*l.attr("data-delay")):n())};var o={giot:function(t,i){function e(t,i,e,n,a){for(var o=i;i+a>o;){for(var r=e;e+n>r;)g[o+"-"+r]=t,++r>u&&(u=r);++o>d&&(d=o)}}var n=i.runtime,o=n.limitRow,r=n.limitCol,l=0,h=0,u=n.totalCol,d=n.totalRow,s={},c=n.holes,f=null,g=n.matrix,m=Math.max(r,o),w=null,v=null,p=o>r?1:0,x=null,M=Math.min(r,o);for(var b in c)c.hasOwnProperty(b)&&e(c[b].id||!0,c[b].top,c[b].left,c[b].width,c[b].height);for(var k=0;m>k&&t.length;++k){p?h=k:l=k,x=null;for(var y=0;M>y&&t.length;++y)if(p?l=y:h=y,!n.matrix[h+"-"+l]){w=a.getFreeArea(h,l,n),f=null;for(var b=0;b<t.length;++b)if(!(t[b].height>w.height||t[b].width>w.width)){f=t.splice(b,1)[0];break}if(null==f&&null==i.fixSize){if(x&&!p&&n.minHoB>w.height){x.height+=w.height,e(x.id,x.y,x.x,x.width,x.height),a.setBlock(x,i);continue}if(x&&p&&n.minWoB>w.width){x.width+=w.width,e(x.id,x.y,x.x,x.width,x.height),a.setBlock(x,i);continue}for(var b=0;b<t.length;++b)if(null==t[b].fixSize){f=t.splice(b,1)[0],p?(f.width=w.width,"auto"==i.cellH&&a.adjustBlock(f,i),f.height=Math.min(f.height,w.height)):(f.height=w.height,f.width=Math.min(f.width,w.width));break}}if(null!=f)s[f.id]={id:f.id,x:l,y:h,width:f.width,height:f.height,fixSize:f.fixSize},x=s[f.id],e(x.id,x.y,x.x,x.width,x.height),a.setBlock(x,i);else{var v={x:l,y:h,fixSize:0};if(p){v.width=w.width,v.height=0;for(var B=l-1,H=h;g[H+"-"+B];)g[H+"-"+l]=!0,v.height+=1,H+=1}else{v.height=w.height,v.width=0;for(var H=h-1,B=l;g[H+"-"+B];)g[h+"-"+B]=!0,v.width+=1,B+=1}i.onGapFound(a.setBlock(v,i),i)}}}n.matrix=g,n.totalRow=d,n.totalCol=u}};window.brickwork=function(n){var r=t(n);"static"==r.css("position")&&r.css("position","relative");var l=Number.MAX_VALUE,h=this;a.totalGrid+=1;var u=t.extend({},a.defaultConfig),d={blocks:{},events:{},matrix:{},holes:{},cellW:0,cellH:0,cellS:1,filter:"",lastId:0,length:0,maxWoB:0,maxHoB:0,minWoB:l,minHoB:l,running:0,gutterX:15,gutterY:15,totalCol:0,totalRow:0,limitCol:666666,limitRow:666666,currentMethod:null,currentArguments:[]};u.runtime=d,d.totalGrid=a.totalGrid;var s=document.body.style;a.transition||(null!=s.webkitTransition||null!=s.MozTransition||null!=s.msTransition||null!=s.OTransition||null!=s.transition)&&(a.transition=!0),h.container=r,h.addCustomEvent=function(t,i){var e=d.events;return t=t.toLowerCase(),!e[t]&&(e[t]=[]),i.eid=e[t].length,e[t].push(i),this},h.appendBlock=function(e){var n=t(e).appendTo(r),l=null,h=[];n.each(function(t,i){i.index=++t,(l=a.loadBlock(i,u))&&h.push(l)}),o[u.engine](h,u),a.setWallSize(d,r),d.length=n.length,n.each(function(t,e){a.showBlock(e,u),(u.draggable||e.getAttribute("data-draggable"))&&i(e)})},h.appendHoles=function(t){var i,e=[].concat(t),n={};for(i=0;i<e.length;++i)n=e[i],d.holes[n.top+"-"+n.left+"-"+n.width+"-"+n.height]=n;return this},h.destroy=function(){var i=r.find(u.selector).removeAttr("id");i.each(function(i,e){$item=t(e);var n=1*$item.attr("data-width")||"",a=1*$item.attr("data-height")||"";$item.width(n).height(a).css({position:"static"})})},h.fillHoles=function(t){if(0==arguments.length)d.holes={};else{var i,e=[].concat(t),n={};for(i=0;i<e.length;++i)n=e[i],d.holes[n.top+"-"+n.left+"-"+n.width+"-"+n.height]=null}return this},h.filter=function(t){return d.filter=t,d.currentMethod&&this.refresh(),this},h.fireEvent=function(t,i,e){var n=d.events;if(t=t.toLowerCase(),n[t]&&n[t].length)for(var a=0;a<n[t].length;++a)n[t][a].call(this,i,e);return this},h.fitHeight=function(n){var l=r.find(u.selector).removeAttr("id"),s=null,c=[];n=n?n:r.height()||e.height(),d.currentMethod=arguments.callee,d.currentArguments=arguments,a.resetGrid(d),a.adjustUnit("auto",n,u),d.filter?(l.data("active",0),l.filter(d.filter).data("active",1)):l.data("active",1),l.each(function(i,e){var n=t(e);e.index=++i,(s=a.loadBlock(e,u))&&n.data("active")&&c.push(s)}),h.fireEvent("onGridReady",r,u),o[u.engine](c,u),a.setWallSize(d,r),h.fireEvent("onGridArrange",r,u),d.length=l.length,l.each(function(t,e){a.showBlock(e,u),(u.draggable||e.getAttribute("data-draggable"))&&i(e)})},h.fitWidth=function(n){var l=r.find(u.selector).removeAttr("id"),s=null,c=[];n=n?n:r.width()||e.width(),d.currentMethod=arguments.callee,d.currentArguments=arguments,a.resetGrid(d),a.adjustUnit(n,"auto",u),d.filter?(l.data("active",0),l.filter(d.filter).data("active",1)):l.data("active",1),l.each(function(i,e){var n=t(e);e.index=++i,(s=a.loadBlock(e,u))&&n.data("active")&&c.push(s)}),h.fireEvent("onGridReady",r,u),o[u.engine](c,u),a.setWallSize(d,r),h.fireEvent("onGridArrange",r,u),d.length=l.length,l.each(function(t,e){a.showBlock(e,u),(u.draggable||e.getAttribute("data-draggable"))&&i(e)})},h.fitZone=function(n,l){var s=r.find(u.selector).removeAttr("id"),c=null,f=[];l=l?l:r.height()||e.height(),n=n?n:r.width()||e.width(),d.currentMethod=arguments.callee,d.currentArguments=arguments,a.resetGrid(d),a.adjustUnit(n,l,u),d.filter?(s.data("active",0),s.filter(d.filter).data("active",1)):s.data("active",1),s.each(function(i,e){var n=t(e);e.index=++i,(c=a.loadBlock(e,u))&&n.data("active")&&f.push(c)}),h.fireEvent("onGridReady",r,u),o[u.engine](f,u),a.setWallSize(d,r),h.fireEvent("onGridArrange",r,u),d.length=s.length,s.each(function(t,e){a.showBlock(e,u),(u.draggable||e.getAttribute("data-draggable"))&&i(e)})},h.fixPos=function(i){return t(i.block).attr({"data-position":i.top+"-"+i.left}),this},h.fixSize=function(i){return null!=i.width&&t(i.block).attr({"data-width":i.width}),null!=i.height&&t(i.block).attr({"data-height":i.height}),this},h.prepend=function(t){return r.prepend(t),d.currentMethod&&this.refresh(),this},h.refresh=function(){var t=arguments.length?arguments:d.currentArguments;return null==d.currentMethod&&(d.currentMethod=this.fitWidth),d.currentMethod.apply(this,Array.prototype.slice.call(t,0)),this},h.reset=function(i){return t.extend(u,i),this},h.setHoles=function(t){var i,e=[].concat(t),n={};for(d.holes={},i=0;i<e.length;++i)n=e[i],d.holes[n.top+"-"+n.left+"-"+n.width+"-"+n.height]=n;return this},h.unFilter=function(){return delete d.filter,this.refresh(),this},r.attr("data-min-width",80*Math.floor(e.width()/80));for(var c in a.plugin)a.plugin.hasOwnProperty(c)&&a.plugin[c].call(h,u,r);e.resize(function(){d.running||(d.running=1,setTimeout(function(){d.running=0,u.onResize.call(h,r)},122),r.attr("data-min-width",80*Math.floor(e.width()/80)))})},brickwork.addConfig=function(i){t.extend(a.defaultConfig,i)},brickwork.createEngine=function(i){t.extend(o,i)},brickwork.createPlugin=function(i){t.extend(a.plugin,i)},brickwork.getMethod=function(t){return a[t]}}(window.Zepto||window.jQuery);